<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>在线图片处理工具 - 格式转换、压缩、裁剪、水印</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- 第三方库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exif-js/2.3.0/exif.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>🖼️ 在线图片处理工具</h1>
            <p>无需注册，浏览器端处理，保护您的隐私</p>
        </header>

        <main class="main-content">
            <!-- 文件上传区域 -->
            <div class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-content">
                        <div class="upload-icon">📁</div>
                        <h3>拖拽图片到此处或点击选择</h3>
                        <p>支持 JPG、PNG、WEBP、AVIF、GIF 格式</p>
                        <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
                        <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                            选择图片
                        </button>
                    </div>
                </div>
                <div class="file-list" id="fileList"></div>
            </div>

            <!-- 功能选项卡 -->
            <div class="tabs-container">
                <div class="tabs-header">
                    <button class="tab-btn active" data-tab="convert">格式转换</button>
                    <button class="tab-btn" data-tab="compress">压缩优化</button>
                    <button class="tab-btn" data-tab="crop">裁剪编辑</button>
                    <button class="tab-btn" data-tab="watermark">添加水印</button>
                    <button class="tab-btn" data-tab="gif">GIF 编辑</button>
                    <button class="tab-btn" data-tab="video">视频转图</button>
                    <button class="tab-btn" data-tab="exif">EXIF 信息</button>
                </div>

                <!-- 格式转换选项卡 -->
                <div class="tab-content active" id="convert">
                    <div class="settings-panel">
                        <div class="setting-group">
                            <label>目标格式：</label>
                            <select id="targetFormat">
                                <option value="image/jpeg">JPG</option>
                                <option value="image/png">PNG</option>
                                <option value="image/webp">WEBP</option>
                                <option value="image/avif">AVIF</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <label>最大宽度：</label>
                            <input type="number" id="maxWidth" placeholder="保持原尺寸">
                        </div>
                        <div class="setting-group">
                            <label>最大高度：</label>
                            <input type="number" id="maxHeight" placeholder="保持原尺寸">
                        </div>
                        <div class="setting-group">
                            <label>JPEG 质量：</label>
                            <input type="range" id="jpegQuality" min="1" max="100" value="85">
                            <span id="qualityValue">85%</span>
                        </div>
                    </div>
                    <button class="process-btn" onclick="processConvert()">开始转换</button>
                </div>

                <!-- 压缩优化选项卡 -->
                <div class="tab-content" id="compress">
                    <div class="settings-panel">
                        <div class="setting-group">
                            <label>压缩质量：</label>
                            <input type="range" id="compressQuality" min="1" max="100" value="80">
                            <span id="compressQualityValue">80%</span>
                        </div>
                        <div class="setting-group">
                            <label>最大文件大小：</label>
                            <select id="maxFileSize">
                                <option value="0">无限制</option>
                                <option value="100">100KB</option>
                                <option value="500">500KB</option>
                                <option value="1024">1MB</option>
                                <option value="2048">2MB</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <label>保持宽高比：</label>
                            <input type="checkbox" id="keepAspectRatio" checked>
                        </div>
                    </div>
                    <button class="process-btn" onclick="processCompress()">开始压缩</button>
                </div>

                <!-- 裁剪编辑选项卡 -->
                <div class="tab-content" id="crop">
                    <div class="crop-container">
                        <div class="crop-preview" id="cropPreview">
                            <canvas id="cropCanvas"></canvas>
                        </div>
                        <div class="crop-controls">
                            <div class="setting-group">
                                <label>裁剪比例：</label>
                                <select id="cropRatio">
                                    <option value="free">自由比例</option>
                                    <option value="1:1">1:1 (正方形)</option>
                                    <option value="4:3">4:3</option>
                                    <option value="16:9">16:9</option>
                                    <option value="3:2">3:2</option>
                                </select>
                            </div>
                            <div class="setting-group">
                                <label>X 坐标：</label>
                                <input type="number" id="cropX" min="0">
                            </div>
                            <div class="setting-group">
                                <label>Y 坐标：</label>
                                <input type="number" id="cropY" min="0">
                            </div>
                            <div class="setting-group">
                                <label>宽度：</label>
                                <input type="number" id="cropWidth" min="1">
                            </div>
                            <div class="setting-group">
                                <label>高度：</label>
                                <input type="number" id="cropHeight" min="1">
                            </div>
                        </div>
                    </div>
                    <button class="process-btn" onclick="processCrop()">应用裁剪</button>
                </div>

                <!-- 添加水印选项卡 -->
                <div class="tab-content" id="watermark">
                    <div class="settings-panel">
                        <div class="setting-group">
                            <label>水印类型：</label>
                            <select id="watermarkType">
                                <option value="text">文字水印</option>
                                <option value="image">图片水印</option>
                            </select>
                        </div>
                        <div class="setting-group" id="textWatermarkOptions">
                            <label>水印文字：</label>
                            <input type="text" id="watermarkText" placeholder="输入水印文字">
                        </div>
                        <div class="setting-group" id="imageWatermarkOptions" style="display: none;">
                            <label>水印图片：</label>
                            <input type="file" id="watermarkImage" accept="image/*">
                        </div>
                        <div class="setting-group">
                            <label>字体大小：</label>
                            <input type="range" id="watermarkSize" min="12" max="72" value="24">
                            <span id="watermarkSizeValue">24px</span>
                        </div>
                        <div class="setting-group">
                            <label>透明度：</label>
                            <input type="range" id="watermarkOpacity" min="0" max="100" value="50">
                            <span id="watermarkOpacityValue">50%</span>
                        </div>
                        <div class="setting-group">
                            <label>旋转角度：</label>
                            <input type="range" id="watermarkRotation" min="-180" max="180" value="-45">
                            <span id="watermarkRotationValue">-45°</span>
                        </div>
                        <div class="setting-group">
                            <label>位置：</label>
                            <select id="watermarkPosition">
                                <option value="top-left">左上角</option>
                                <option value="top-right">右上角</option>
                                <option value="bottom-left">左下角</option>
                                <option value="bottom-right">右下角</option>
                                <option value="center">中心</option>
                            </select>
                        </div>
                    </div>
                    <button class="process-btn" onclick="processWatermark()">添加水印</button>
                </div>

                <!-- GIF 编辑选项卡 -->
                <div class="tab-content" id="gif">
                    <div class="settings-panel">
                        <div class="setting-group">
                            <label>GIF 操作：</label>
                            <select id="gifOperation">
                                <option value="extract">提取帧</option>
                                <option value="reverse">倒播</option>
                                <option value="resize">调整尺寸</option>
                                <option value="convert">转换格式</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <label>帧率：</label>
                            <input type="number" id="gifFps" min="1" max="30" value="10">
                        </div>
                        <div class="setting-group">
                            <label>质量：</label>
                            <input type="range" id="gifQuality" min="1" max="100" value="75">
                            <span id="gifQualityValue">75%</span>
                        </div>
                    </div>
                    <button class="process-btn" onclick="processGIF()">处理 GIF</button>
                </div>

                <!-- 视频转图选项卡 -->
                <div class="tab-content" id="video">
                    <div class="settings-panel">
                        <div class="setting-group">
                            <label>视频文件：</label>
                            <input type="file" id="videoFile" accept="video/*">
                        </div>
                        <div class="setting-group">
                            <label>起始时间（秒）：</label>
                            <input type="number" id="videoStartTime" min="0" value="0" step="0.1">
                        </div>
                        <div class="setting-group">
                            <label>持续时间（秒）：</label>
                            <input type="number" id="videoDuration" min="0.1" value="3" step="0.1">
                        </div>
                        <div class="setting-group">
                            <label>输出格式：</label>
                            <select id="videoOutputFormat">
                                <option value="gif">GIF</option>
                                <option value="webp">WebP 动画</option>
                            </select>
                        </div>
                    </div>
                    <button class="process-btn" onclick="processVideo()">转换视频</button>
                </div>

                <!-- EXIF 信息选项卡 -->
                <div class="tab-content" id="exif">
                    <div class="exif-display" id="exifDisplay">
                        <p>选择图片后显示 EXIF 信息</p>
                    </div>
                    <button class="process-btn" onclick="readEXIF()">读取 EXIF</button>
                </div>
            </div>

            <!-- 处理结果区域 -->
            <div class="results-section" id="resultsSection" style="display: none;">
                <h3>处理结果</h3>
                <div class="results-grid" id="resultsGrid"></div>
                <div class="download-actions">
                    <button class="download-btn" onclick="downloadAll()">下载所有文件</button>
                    <button class="download-btn" onclick="downloadZip()">打包下载 ZIP</button>
                </div>
            </div>
        </main>
    </div>

    <!-- JavaScript 模块 -->
    <script src="js/utils.js"></script>
    <script src="js/convert.js"></script>
    <script src="js/compress.js"></script>
    <script src="js/crop.js"></script>
    <script src="js/watermark.js"></script>
    <script src="js/gif.js"></script>
    <script src="js/video.js"></script>
    <script src="js/exif.js"></script>
    <script src="js/core.js"></script>
</body>
</html> 